<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Neon Flappy</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      .glow {
        box-shadow: 0 0 18px rgba(34, 211, 238, 0.7), 0 0 36px rgba(217, 70, 239, 0.35);
      }
      .panel {
        background: rgba(255, 255, 255, 0.06);
        border: 1px solid rgba(255, 255, 255, 0.12);
        backdrop-filter: blur(16px);
      }
      canvas { display:block; }
    </style>
  </head>
  <body class="min-h-screen bg-slate-950 text-slate-100">
    <div class="fixed inset-0 pointer-events-none">
      <div class="absolute -top-24 -left-24 h-80 w-80 rounded-full bg-cyan-500/30 blur-[120px]"></div>
      <div class="absolute top-32 right-0 h-96 w-96 rounded-full bg-fuchsia-500/25 blur-[140px]"></div>
      <div class="absolute bottom-0 left-1/3 h-72 w-72 rounded-full bg-emerald-500/20 blur-[120px]"></div>
    </div>

    <main class="relative z-10 w-screen h-screen flex items-center justify-center">
      <div class="panel glow w-full h-full">
        <div class="relative w-full h-full">
          <canvas id="game" class="w-full h-full"></canvas>

          <!-- HUD -->
          <div class="absolute top-4 left-4 flex gap-3 text-sm">
            <div class="px-3 py-2 rounded-lg bg-white/10">Score: <span id="score" class="text-cyan-200 font-semibold">0</span></div>
            <div class="px-3 py-2 rounded-lg bg-white/10">Best: <span id="best" class="text-fuchsia-200 font-semibold">0</span></div>
          </div>

          <!-- Buttons inside game -->
          <div class="absolute top-4 right-4 flex gap-2">
            <button id="startBtn" class="px-4 py-2 rounded-lg bg-cyan-500/80 text-white hover:bg-cyan-400/80">Start</button>
            <button id="resetBtn" class="px-4 py-2 rounded-lg border border-white/10 text-slate-200 hover:bg-white/5">Reset</button>
            <button id="soundBtn" class="px-4 py-2 rounded-lg border border-white/10 text-slate-200 hover:bg-white/5">Sound: On</button>
          </div>

          <div id="status" class="absolute bottom-4 left-1/2 -translate-x-1/2 text-xs text-slate-300 bg-white/10 px-4 py-2 rounded-full">Press Start or Space to play</div>
        </div>
      </div>
    </main>

    <script>
      const canvas = document.getElementById('game');
      const ctx = canvas.getContext('2d');
      const scoreEl = document.getElementById('score');
      const bestEl = document.getElementById('best');
      const statusEl = document.getElementById('status');
      const startBtn = document.getElementById('startBtn');
      const resetBtn = document.getElementById('resetBtn');
      const soundBtn = document.getElementById('soundBtn');

      const bestScore = Number(localStorage.getItem('neon-flappy-best') || 0);
      bestEl.textContent = bestScore;

      let running = false;
      let score = 0;
      let frame = 0;
      let soundOn = true;

      const bird = {
        x: 140,
        y: 200,
        r: 16,
        vy: 0,
        gravity: 0.45,
        lift: -7.5,
      };

      const pipes = [];
      const pipeGap = 160;
      const pipeWidth = 70;
      const pipeSpeed = 2.8;

      const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      function beep(freq, duration = 0.08, volume = 0.05) {
        if (!soundOn) return;
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.type = 'sine';
        osc.frequency.value = freq;
        gain.gain.value = volume;
        osc.connect(gain).connect(audioCtx.destination);
        osc.start();
        osc.stop(audioCtx.currentTime + duration);
      }

      function resize() {
        canvas.width = canvas.clientWidth;
        canvas.height = canvas.clientHeight;
      }
      window.addEventListener('resize', resize);

      function resetGame() {
        running = false;
        score = 0;
        frame = 0;
        bird.y = canvas.height / 2;
        bird.vy = 0;
        pipes.length = 0;
        scoreEl.textContent = score;
        statusEl.textContent = 'Press Start or Space to play';
      }

      function spawnPipe() {
        const gapTop = Math.random() * (canvas.height - pipeGap - 120) + 60;
        pipes.push({ x: canvas.width + 40, gapTop, scored: false });
      }

      function flap() {
        if (!running) return;
        bird.vy = bird.lift;
        beep(520);
      }

      function collide(pipe) {
        const withinX = bird.x + bird.r > pipe.x && bird.x - bird.r < pipe.x + pipeWidth;
        if (!withinX) return false;
        const hitTop = bird.y - bird.r < pipe.gapTop;
        const hitBottom = bird.y + bird.r > pipe.gapTop + pipeGap;
        return hitTop || hitBottom;
      }

      function update() {
        if (!running) return;
        frame++;
        bird.vy += bird.gravity;
        bird.y += bird.vy;

        if (frame % 90 === 0) spawnPipe();

        for (const pipe of pipes) {
          pipe.x -= pipeSpeed;
          if (!pipe.scored && pipe.x + pipeWidth < bird.x) {
            pipe.scored = true;
            score++;
            scoreEl.textContent = score;
            statusEl.textContent = 'Nice!';
            beep(760);
          }
        }

        if (pipes.length && pipes[0].x + pipeWidth < -40) pipes.shift();

        if (bird.y - bird.r < 0 || bird.y + bird.r > canvas.height) {
          endGame();
        }

        for (const pipe of pipes) {
          if (collide(pipe)) {
            endGame();
            break;
          }
        }
      }

      function endGame() {
        running = false;
        statusEl.textContent = 'Game Over!';
        beep(220, 0.2, 0.08);
        if (score > bestScore) {
          localStorage.setItem('neon-flappy-best', score);
          bestEl.textContent = score;
        }
      }

      function drawBackground() {
        ctx.fillStyle = '#0b1020';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
        gradient.addColorStop(0, 'rgba(34,211,238,0.15)');
        gradient.addColorStop(1, 'rgba(217,70,239,0.08)');
        ctx.fillStyle = gradient;
        ctx.fillRect(0, 0, canvas.width, canvas.height);
      }

      function drawPipes() {
        for (const pipe of pipes) {
          ctx.fillStyle = 'rgba(34,211,238,0.7)';
          ctx.shadowColor = 'rgba(34,211,238,0.6)';
          ctx.shadowBlur = 14;
          ctx.fillRect(pipe.x, 0, pipeWidth, pipe.gapTop);
          ctx.fillRect(pipe.x, pipe.gapTop + pipeGap, pipeWidth, canvas.height);
        }
        ctx.shadowBlur = 0;
      }

      function drawBird() {
        ctx.beginPath();
        ctx.fillStyle = 'rgba(236,72,153,0.9)';
        ctx.shadowColor = 'rgba(236,72,153,0.7)';
        ctx.shadowBlur = 16;
        ctx.arc(bird.x, bird.y, bird.r, 0, Math.PI * 2);
        ctx.fill();
        ctx.shadowBlur = 0;
      }

      function drawText() {
        if (running) return;
        ctx.fillStyle = 'rgba(255,255,255,0.8)';
        ctx.font = '20px Inter, sans-serif';
        ctx.textAlign = 'center';
        ctx.fillText('Press Start or Space to play', canvas.width / 2, canvas.height / 2);
      }

      function draw() {
        drawBackground();
        drawPipes();
        drawBird();
        drawText();
      }

      function loop() {
        update();
        draw();
        requestAnimationFrame(loop);
      }

      startBtn.addEventListener('click', () => {
        if (!running) {
          running = true;
          statusEl.textContent = 'Go!';
          if (audioCtx.state === 'suspended') audioCtx.resume();
        }
      });

      resetBtn.addEventListener('click', () => {
        resetGame();
      });

      soundBtn.addEventListener('click', () => {
        soundOn = !soundOn;
        soundBtn.textContent = `Sound: ${soundOn ? 'On' : 'Off'}`;
        if (audioCtx.state === 'suspended') audioCtx.resume();
      });

      window.addEventListener('keydown', (e) => {
        if (e.code === 'Space') {
          if (!running) running = true;
          if (audioCtx.state === 'suspended') audioCtx.resume();
          flap();
        }
      });

      canvas.addEventListener('click', () => {
        if (!running) running = true;
        if (audioCtx.state === 'suspended') audioCtx.resume();
        flap();
      });

      resize();
      resetGame();
      loop();
    </script>
  </body>
</html>
